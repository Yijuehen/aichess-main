# ğŸ“š è„šæœ¬æ–‡ä»¶è¯´æ˜

## ğŸ¯ å¿«é€Ÿå¼€å§‹

ä¸Šä¼ è¿™äº›æ–‡ä»¶åˆ°æœåŠ¡å™¨ `/tmp/aichess-main/` ç›®å½•ï¼š

### å¿…é¡»æ–‡ä»¶
1. âœ… collect.py - æ•°æ®æ”¶é›†ä¸»ç¨‹åº
2. âœ… config.py - é…ç½®æ–‡ä»¶
3. âœ… train.py - è®­ç»ƒç¨‹åº
4. âœ… run_parallel_collect.sh - å¤šGPUå¹¶è¡Œæ”¶é›†ï¼ˆä¸»è¦ï¼‰
5. âœ… run_distributed_train.sh - å¤šGPUè®­ç»ƒ

### è¾…åŠ©è„šæœ¬ï¼ˆæ¨èï¼‰
6. âœ… start_collect.sh - å¿«é€Ÿå¯åŠ¨
7. âœ… stop_collect.sh - å¿«é€Ÿåœæ­¢
8. âœ… monitor.sh - å®æ—¶ç›‘æ§
9. âœ… export_redis_data.sh - å¯¼å‡ºRedisæ•°æ®åˆ° train_data_buffer.pklï¼ˆå¤‡ä»½ï¼‰

### æ–‡æ¡£
11. âœ… SCRIPTS_GUIDE.md - è¯¦ç»†ä½¿ç”¨æŒ‡å—

---

## ğŸ“– è„šæœ¬åŠŸèƒ½ä¸€è§ˆ

| è„šæœ¬ | åŠŸèƒ½ | ä½•æ—¶ä½¿ç”¨ |
|------|------|----------|
| **start_collect.sh** | å¯åŠ¨collect | æ¯æ¬¡å¯åŠ¨æ•°æ®æ”¶é›† |
| **stop_collect.sh** | åœæ­¢collect | åœæ­¢æ•°æ®æ”¶é›† |
| **monitor.sh** | å®æ—¶ç›‘æ§ | æŸ¥çœ‹æ”¶é›†è¿›åº¦å’ŒçŠ¶æ€ |
| **export_redis_data.sh** | å¯¼å‡ºå¤‡ä»½ | å¤‡ä»½Redisæ•°æ®åˆ° train_data_buffer.pkl |
| **run_parallel_collect.sh** | ä¸»æ”¶é›†è„šæœ¬ | ç”±start_collectè°ƒç”¨ |
| **run_distributed_train.sh** | è®­ç»ƒè„šæœ¬ | è®­ç»ƒæ¨¡å‹æ—¶ä½¿ç”¨ |

---

## ğŸš€ æœ€ç®€å•çš„ä½¿ç”¨æµç¨‹

```bash
# 1. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
scp *.sh *.py user@server:/tmp/aichess-main/

# 2. SSHç™»å½•æœåŠ¡å™¨
ssh user@server

# 3. è¿›å…¥ç›®å½•
cd /tmp/aichess-main

# 4. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x *.sh

# 5. å¯åŠ¨æ•°æ®æ”¶é›†
./start_collect.sh

# 6. ç›‘æ§è¿›åº¦ï¼ˆå¦å¼€ç»ˆç«¯ï¼‰
./monitor.sh

# 7. é€€å‡ºSSHï¼Œç¨‹åºç»§ç»­è¿è¡Œ
exit

# 8. ä¸‹æ¬¡ç™»å½•æŸ¥çœ‹
ssh user@server
cd /tmp/aichess-main
./monitor.sh
```

---

## ğŸ’¾ æ•°æ®å¤‡ä»½

```bash
# å¯¼å‡ºå½“å‰Redisæ•°æ®åˆ° train_data_buffer.pkl
./export_redis_data.sh

# æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶
ls -lh train_data_buffer.pkl
```

**å¯¼å‡ºè¯´æ˜**ï¼š
- å›ºå®šæ–‡ä»¶åï¼š`train_data_buffer.pkl`
- æ¯æ¬¡å¯¼å‡ºè¦†ç›–æ—§æ–‡ä»¶
- é˜²æ­¢Redisé‡å¯å¯¼è‡´æ•°æ®ä¸¢å¤±

---

## ğŸ“Š ç›‘æ§è„šæœ¬è¾“å‡ºç¤ºä¾‹

```
========================================
ğŸ“Š Collectç›‘æ§ - 2026-01-22 12:45:30
========================================

ğŸ–¥ï¸  è¿›ç¨‹çŠ¶æ€:
   âœ… è¿è¡Œä¸­
   PID: 80549, CPU: 98%, MEM: 0.1%, è¿è¡Œæ—¶é—´: 05:30

ğŸ“ˆ æ•°æ®è¿›åº¦:
   æ¸¸æˆå±€æ•°: 28
   è®­ç»ƒæ ·æœ¬: 2520
   è¿›åº¦: 0% (ç›®æ ‡: 5000å±€)

ğŸ® GPUçŠ¶æ€:
   GPU 0: NVIDIA A100-SXM4-80GB - åˆ©ç”¨ç‡ 23%, æ˜¾å­˜ 706M/81920M
   GPU 1: NVIDIA A100-SXM4-80GB - åˆ©ç”¨ç‡ 20%, æ˜¾å­˜ 696M/81920M

ğŸ“ æœ€æ–°æ—¥å¿—ï¼ˆæœ€å3è¡Œï¼‰:
âœ… Game completed! èƒœè€…: å¹³å±€, æ­¥æ•°: 47
âœ… Rediså·²æ›´æ–°! æ€»å±€æ•°: 28
ğŸ® Game 2/1 starting...

========================================
```

---

## ğŸ›‘ åœæ­¢è„šæœ¬è¾“å‡ºç¤ºä¾‹

```
========================================
ğŸ›‘ åœæ­¢Collect
========================================

åœæ­¢è¿›ç¨‹: 80549
âœ… å·²åœæ­¢

éªŒè¯:
âœ… æ‰€æœ‰è¿›ç¨‹å·²åœæ­¢

æ•°æ®çŠ¶æ€:
  å·²æ”¶é›†å±€æ•°: 28
  è®­ç»ƒæ ·æœ¬æ•°: 2520

========================================
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### ä¿®æ”¹GPUæ£€æµ‹å‚æ•°

ç¼–è¾‘ `run_parallel_collect.sh`:

```bash
MIN_GPU_MEMORY_MB=2000  # æœ€å°éœ€è¦GPUå†…å­˜ï¼ˆMBï¼‰
MAX_GPU_UTIL=90         # æœ€å¤§GPUåˆ©ç”¨ç‡ï¼ˆ%ï¼‰
```

### ä¿®æ”¹Redisé…ç½®

ç¼–è¾‘ `config.py`:

```python
'use_redis': True,  # ä½¿ç”¨Rediså­˜å‚¨
'redis_host': 'localhost',
'redis_port': 6379,
```

---

## ğŸ“ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# === åŸºæœ¬æ“ä½œ ===
./start_collect.sh           # å¯åŠ¨
./stop_collect.sh            # åœæ­¢
./monitor.sh                 # ç›‘æ§

# === æŸ¥çœ‹çŠ¶æ€ ===
redis-cli GET iters          # æŸ¥çœ‹å±€æ•°
redis-cli LLEN train_data_buffer  # æŸ¥çœ‹æ ·æœ¬æ•°
ps aux | grep collect.py     # æŸ¥çœ‹è¿›ç¨‹
nvidia-smi                   # æŸ¥çœ‹GPU

# === æ—¥å¿— ===
tail -f nohup_collect.log    # å®æ—¶æ—¥å¿—
tail -50 nohup_collect.log   # æœ€è¿‘50è¡Œ

# === æ•°æ®ç®¡ç† ===
./export_redis_data.sh       # å¯¼å‡ºå¤‡ä»½åˆ° train_data_buffer.pkl
```

---

## ğŸ¯ ä½¿ç”¨å»ºè®®

### åˆæ¬¡ä½¿ç”¨ï¼ˆç¬¬1å‘¨ï¼‰
1. å¯åŠ¨collectï¼Œæ”¶é›†500-1000å±€æ•°æ®
2. å®šæœŸå¯¼å‡ºå¤‡ä»½ï¼ˆæ¯100å±€ï¼‰
3. ä¸è¦æ€¥äºè®­ç»ƒ

### æŒç»­ä½¿ç”¨ï¼ˆç¬¬2å‘¨èµ·ï¼‰
1. è¾¾åˆ°1000å±€åï¼Œå¼€å§‹è®­ç»ƒ
2. åŒæ—¶è¿è¡Œcollectï¼ˆ1ä¸ªGPUï¼‰+ trainï¼ˆ1ä¸ªGPUï¼‰
3. æ¯å¤©å¯¼å‡ºä¸€æ¬¡å¤‡ä»½

### æœ€ä½³å®è·µ
- âœ… æ¯å¤©æˆ–æ¯è¾¾åˆ°ä¸€å®šå±€æ•°åå¤‡ä»½ä¸€æ¬¡æ•°æ®
- âœ… é‡å¯æœåŠ¡å™¨å‰åŠ¡å¿…å¯¼å‡ºå¤‡ä»½
- âœ… å®šæœŸæ£€æŸ¥å¤‡ä»½æ–‡ä»¶å¤§å°
- âœ… è¾¾åˆ°5000å±€åä¿å­˜æ¨¡å‹

---

## ğŸ“ è·å–å¸®åŠ©

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·æŸ¥çœ‹ï¼š
```bash
cat SCRIPTS_GUIDE.md
```

---

## ğŸ‰ æ€»ç»“

**6ä¸ªè„šæœ¬ï¼Œè¦†ç›–æ‰€æœ‰éœ€æ±‚ï¼**

1. âœ… **å¯åŠ¨/åœæ­¢/ç›‘æ§** - start/stop/monitor
2. âœ… **æ•°æ®å¤‡ä»½** - export (å¯¼å‡ºåˆ° train_data_buffer.pkl)
3. âœ… **å¹¶è¡Œæ”¶é›†** - run_parallel_collect
4. âœ… **åˆ†å¸ƒå¼è®­ç»ƒ** - run_distributed_train
5. âœ… **å®Œæ•´æ–‡æ¡£** - SCRIPTS_GUIDE.md

**ç®€å•ã€ç¨³å®šã€è‡ªåŠ¨åŒ–ï¼** ğŸš€
